<link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/material_red.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>

<script>
flatpickr('#appels_dateDebut', {
    enableTime: true,
    time_24hr: true,
    minTime: "07:00",
    maxTime: "20:00",
    defaultHour: "07:00",
    altInput: true,
    altFormat: "d-m-Y H:i",
    dateFormat: "d-m-Y H:i",
    minDate: "today",
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
    onChange: function(selectedDates, dateStr, instance) {
        var minToAdd = 1; // add 2 hours
        var maxTime = instance.config.maxTime;
        var selectedDate = new Date(selectedDates);
        selectedDate.setHours(selectedDate.getHours() + minToAdd);

        var endDatePicker = document.querySelector('#appels_dateFin');
        var endDatePickerInstance = endDatePicker._flatpickr;
        endDatePickerInstance.setDate(selectedDate, false, 'd-m-Y H:i');
    }
});

flatpickr('#appels_dateFin', {
    enableTime: true,
    time_24hr: true,
    minTime: "07:00",
    maxTime: "20:00",
    defaultHour: "07:00",
    altInput: true,
    altFormat: "d-m-Y H:i",
    dateFormat: "d-m-Y H:i",
    minDate: "today",
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
});

flatpickr('#chantier_apps_dateDebut', {
    altInput: true,
    altFormat: 'd-m-Y',
    dateFormat: 'Y-m-d',
    minDate: 'today',
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
    onChange: function(selectedDates, dateStr, instance) {
        var selectedDate = new Date(selectedDates);
        var endDatePicker = document.querySelector('#chantier_apps_dateFin');
        var endDatePickerInstance = endDatePicker._flatpickr;

        // If endDatePicker is empty or its value is before the selected date, update it
        if (endDatePicker.value === '' || new Date(endDatePicker.value) <= selectedDate) {
            var nextValidDate = new Date(selectedDate);
            while (nextValidDate.getDay() === 6 || nextValidDate.getDay() === 0) {
                nextValidDate.setDate(nextValidDate.getDate() + 2);
            }
            endDatePickerInstance.setDate(nextValidDate, false, 'Y-m-d');
        }
    }
});

flatpickr('#chantier_apps_dateFin', {
    altInput: true,
    altFormat: 'd-m-Y',
    dateFormat: 'Y-m-d',
    minDate: "today",
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
});

flatpickr('#appels_edit_dateDebut', {
    enableTime: true,
    time_24hr: true,
    minTime: "07:00",
    maxTime: "20:00",
    defaultHour: "07:00",
    altInput: true,
    altFormat: "d-m-Y H:i",
    dateFormat: "d-m-Y H:i",
    minDate: "today",
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
    onChange: function(selectedDates, dateStr, instance) {
        var minToAdd = 1; // add 2 hours
        var maxTime = instance.config.maxTime;
        var selectedDate = new Date(selectedDates);
        selectedDate.setHours(selectedDate.getHours() + minToAdd);

        var endDatePicker = document.querySelector('#appels_dateFin');
        var endDatePickerInstance = endDatePicker._flatpickr;
        endDatePickerInstance.setDate(selectedDate, false, 'd-m-Y H:i');
    }
});

flatpickr('#appels_edit_dateFin', {
    enableTime: true,
    time_24hr: true,
    minTime: "07:00",
    maxTime: "20:00",
    defaultHour: "07:00",
    altInput: true,
    altFormat: "d-m-Y H:i",
    dateFormat: "d-m-Y H:i",
    minDate: "today",
    disable: [
        function(date) {
            // Disable weekends (Saturday = 6, Sunday = 0)
            return (date.getDay() === 6 || date.getDay() === 0);
        }
    ],
    "locale": "fr",
});

</script>
